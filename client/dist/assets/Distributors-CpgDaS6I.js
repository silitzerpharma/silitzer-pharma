import{f as Ce,j as e,a as ye,g as Se,r as t,u as we,H as $e,I as ce,c as X,J as de,s as pe,K as g,b as ke,m as Pe,d as E,M as Z,L as ie,y as re,P as me,T as Ne,O as De,Q as Ie,S as Te,U as Oe,B as K}from"./index-DlcvTWOH.js";/* empty css              */import{T as ge}from"./TableContainer-CQmYnS7h.js";import{T as be,a as he,b as te,c as O,d as xe}from"./TableRow-DuThesGT.js";import{T as fe}from"./TableSortLabel-Csm9lG0A.js";import{T as ve}from"./TablePagination-C03NsVHS.js";import{D as ee,a as se,b as ae,c as oe}from"./DialogTitle-DGL2koDV.js";import{D as ne}from"./DialogContentText-BFDKx7jj.js";import{T as _e}from"./TextField-Doo77Nta.js";import{S as je}from"./ShowMessage-CBlrf01s.js";import"./LastPage-DpFt_x2b.js";import"./IconButton-eRt6TsSc.js";import"./Select-BpVlYiRl.js";import"./useControlled-CHhDBfC_.js";import"./useFormControl-CXPDb4oN.js";import"./InputLabel-Bd8_Eb26.js";import"./Stack-B0Za308U.js";import"./getThemeProps-DR8AxGiy.js";const Re=Ce(e.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}));function Le(s){return Se("MuiChip",s)}const n=ye("MuiChip",["root","sizeSmall","sizeMedium","colorDefault","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","disabled","clickable","clickableColorPrimary","clickableColorSecondary","deletable","deletableColorPrimary","deletableColorSecondary","outlined","filled","outlinedPrimary","outlinedSecondary","filledPrimary","filledSecondary","avatar","avatarSmall","avatarMedium","avatarColorPrimary","avatarColorSecondary","icon","iconSmall","iconMedium","iconColorPrimary","iconColorSecondary","label","labelSmall","labelMedium","deleteIcon","deleteIconSmall","deleteIconMedium","deleteIconColorPrimary","deleteIconColorSecondary","deleteIconOutlinedColorPrimary","deleteIconOutlinedColorSecondary","deleteIconFilledColorPrimary","deleteIconFilledColorSecondary","focusVisible"]),Ee=s=>{const{classes:r,disabled:a,size:i,color:c,iconColor:p,onDelete:b,clickable:m,variant:u}=s,h={root:["root",u,a&&"disabled",`size${g(i)}`,`color${g(c)}`,m&&"clickable",m&&`clickableColor${g(c)}`,b&&"deletable",b&&`deletableColor${g(c)}`,`${u}${g(c)}`],label:["label",`label${g(i)}`],avatar:["avatar",`avatar${g(i)}`,`avatarColor${g(c)}`],icon:["icon",`icon${g(i)}`,`iconColor${g(p)}`],deleteIcon:["deleteIcon",`deleteIcon${g(i)}`,`deleteIconColor${g(c)}`,`deleteIcon${g(u)}Color${g(c)}`]};return ke(h,Le,r)},Ae=pe("div",{name:"MuiChip",slot:"Root",overridesResolver:(s,r)=>{const{ownerState:a}=s,{color:i,iconColor:c,clickable:p,onDelete:b,size:m,variant:u}=a;return[{[`& .${n.avatar}`]:r.avatar},{[`& .${n.avatar}`]:r[`avatar${g(m)}`]},{[`& .${n.avatar}`]:r[`avatarColor${g(i)}`]},{[`& .${n.icon}`]:r.icon},{[`& .${n.icon}`]:r[`icon${g(m)}`]},{[`& .${n.icon}`]:r[`iconColor${g(c)}`]},{[`& .${n.deleteIcon}`]:r.deleteIcon},{[`& .${n.deleteIcon}`]:r[`deleteIcon${g(m)}`]},{[`& .${n.deleteIcon}`]:r[`deleteIconColor${g(i)}`]},{[`& .${n.deleteIcon}`]:r[`deleteIcon${g(u)}Color${g(i)}`]},r.root,r[`size${g(m)}`],r[`color${g(i)}`],p&&r.clickable,p&&i!=="default"&&r[`clickableColor${g(i)})`],b&&r.deletable,b&&i!=="default"&&r[`deletableColor${g(i)}`],r[u],r[`${u}${g(i)}`]]}})(Pe(({theme:s})=>{const r=s.palette.mode==="light"?s.palette.grey[700]:s.palette.grey[300];return{maxWidth:"100%",fontFamily:s.typography.fontFamily,fontSize:s.typography.pxToRem(13),display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,color:(s.vars||s).palette.text.primary,backgroundColor:(s.vars||s).palette.action.selected,borderRadius:32/2,whiteSpace:"nowrap",transition:s.transitions.create(["background-color","box-shadow"]),cursor:"unset",outline:0,textDecoration:"none",border:0,padding:0,verticalAlign:"middle",boxSizing:"border-box",[`&.${n.disabled}`]:{opacity:(s.vars||s).palette.action.disabledOpacity,pointerEvents:"none"},[`& .${n.avatar}`]:{marginLeft:5,marginRight:-6,width:24,height:24,color:s.vars?s.vars.palette.Chip.defaultAvatarColor:r,fontSize:s.typography.pxToRem(12)},[`& .${n.avatarColorPrimary}`]:{color:(s.vars||s).palette.primary.contrastText,backgroundColor:(s.vars||s).palette.primary.dark},[`& .${n.avatarColorSecondary}`]:{color:(s.vars||s).palette.secondary.contrastText,backgroundColor:(s.vars||s).palette.secondary.dark},[`& .${n.avatarSmall}`]:{marginLeft:4,marginRight:-4,width:18,height:18,fontSize:s.typography.pxToRem(10)},[`& .${n.icon}`]:{marginLeft:5,marginRight:-6},[`& .${n.deleteIcon}`]:{WebkitTapHighlightColor:"transparent",color:s.vars?`rgba(${s.vars.palette.text.primaryChannel} / 0.26)`:E(s.palette.text.primary,.26),fontSize:22,cursor:"pointer",margin:"0 5px 0 -6px","&:hover":{color:s.vars?`rgba(${s.vars.palette.text.primaryChannel} / 0.4)`:E(s.palette.text.primary,.4)}},variants:[{props:{size:"small"},style:{height:24,[`& .${n.icon}`]:{fontSize:18,marginLeft:4,marginRight:-4},[`& .${n.deleteIcon}`]:{fontSize:16,marginRight:4,marginLeft:-4}}},...Object.entries(s.palette).filter(Z(["contrastText"])).map(([a])=>({props:{color:a},style:{backgroundColor:(s.vars||s).palette[a].main,color:(s.vars||s).palette[a].contrastText,[`& .${n.deleteIcon}`]:{color:s.vars?`rgba(${s.vars.palette[a].contrastTextChannel} / 0.7)`:E(s.palette[a].contrastText,.7),"&:hover, &:active":{color:(s.vars||s).palette[a].contrastText}}}})),{props:a=>a.iconColor===a.color,style:{[`& .${n.icon}`]:{color:s.vars?s.vars.palette.Chip.defaultIconColor:r}}},{props:a=>a.iconColor===a.color&&a.color!=="default",style:{[`& .${n.icon}`]:{color:"inherit"}}},{props:{onDelete:!0},style:{[`&.${n.focusVisible}`]:{backgroundColor:s.vars?`rgba(${s.vars.palette.action.selectedChannel} / calc(${s.vars.palette.action.selectedOpacity} + ${s.vars.palette.action.focusOpacity}))`:E(s.palette.action.selected,s.palette.action.selectedOpacity+s.palette.action.focusOpacity)}}},...Object.entries(s.palette).filter(Z(["dark"])).map(([a])=>({props:{color:a,onDelete:!0},style:{[`&.${n.focusVisible}`]:{background:(s.vars||s).palette[a].dark}}})),{props:{clickable:!0},style:{userSelect:"none",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:hover":{backgroundColor:s.vars?`rgba(${s.vars.palette.action.selectedChannel} / calc(${s.vars.palette.action.selectedOpacity} + ${s.vars.palette.action.hoverOpacity}))`:E(s.palette.action.selected,s.palette.action.selectedOpacity+s.palette.action.hoverOpacity)},[`&.${n.focusVisible}`]:{backgroundColor:s.vars?`rgba(${s.vars.palette.action.selectedChannel} / calc(${s.vars.palette.action.selectedOpacity} + ${s.vars.palette.action.focusOpacity}))`:E(s.palette.action.selected,s.palette.action.selectedOpacity+s.palette.action.focusOpacity)},"&:active":{boxShadow:(s.vars||s).shadows[1]}}},...Object.entries(s.palette).filter(Z(["dark"])).map(([a])=>({props:{color:a,clickable:!0},style:{[`&:hover, &.${n.focusVisible}`]:{backgroundColor:(s.vars||s).palette[a].dark}}})),{props:{variant:"outlined"},style:{backgroundColor:"transparent",border:s.vars?`1px solid ${s.vars.palette.Chip.defaultBorder}`:`1px solid ${s.palette.mode==="light"?s.palette.grey[400]:s.palette.grey[700]}`,[`&.${n.clickable}:hover`]:{backgroundColor:(s.vars||s).palette.action.hover},[`&.${n.focusVisible}`]:{backgroundColor:(s.vars||s).palette.action.focus},[`& .${n.avatar}`]:{marginLeft:4},[`& .${n.avatarSmall}`]:{marginLeft:2},[`& .${n.icon}`]:{marginLeft:4},[`& .${n.iconSmall}`]:{marginLeft:2},[`& .${n.deleteIcon}`]:{marginRight:5},[`& .${n.deleteIconSmall}`]:{marginRight:3}}},...Object.entries(s.palette).filter(Z()).map(([a])=>({props:{variant:"outlined",color:a},style:{color:(s.vars||s).palette[a].main,border:`1px solid ${s.vars?`rgba(${s.vars.palette[a].mainChannel} / 0.7)`:E(s.palette[a].main,.7)}`,[`&.${n.clickable}:hover`]:{backgroundColor:s.vars?`rgba(${s.vars.palette[a].mainChannel} / ${s.vars.palette.action.hoverOpacity})`:E(s.palette[a].main,s.palette.action.hoverOpacity)},[`&.${n.focusVisible}`]:{backgroundColor:s.vars?`rgba(${s.vars.palette[a].mainChannel} / ${s.vars.palette.action.focusOpacity})`:E(s.palette[a].main,s.palette.action.focusOpacity)},[`& .${n.deleteIcon}`]:{color:s.vars?`rgba(${s.vars.palette[a].mainChannel} / 0.7)`:E(s.palette[a].main,.7),"&:hover, &:active":{color:(s.vars||s).palette[a].main}}}}))]}})),ze=pe("span",{name:"MuiChip",slot:"Label",overridesResolver:(s,r)=>{const{ownerState:a}=s,{size:i}=a;return[r.label,r[`label${g(i)}`]]}})({overflow:"hidden",textOverflow:"ellipsis",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap",variants:[{props:{variant:"outlined"},style:{paddingLeft:11,paddingRight:11}},{props:{size:"small"},style:{paddingLeft:8,paddingRight:8}},{props:{size:"small",variant:"outlined"},style:{paddingLeft:7,paddingRight:7}}]});function ue(s){return s.key==="Backspace"||s.key==="Delete"}const Fe=t.forwardRef(function(r,a){const i=we({props:r,name:"MuiChip"}),{avatar:c,className:p,clickable:b,color:m="default",component:u,deleteIcon:h,disabled:C=!1,icon:j,label:I,onClick:y,onDelete:k,onKeyDown:S,onKeyUp:L,size:D="medium",variant:_="filled",tabIndex:A,skipFocusWhenDisabled:w=!1,slots:R={},slotProps:v={},...l}=i,d=t.useRef(null),z=$e(d,a),T=x=>{x.stopPropagation(),k&&k(x)},$=x=>{x.currentTarget===x.target&&ue(x)&&x.preventDefault(),S&&S(x)},M=x=>{x.currentTarget===x.target&&k&&ue(x)&&k(x),L&&L(x)},G=b!==!1&&y?!0:b,J=G||k?ce:u||"div",W={...i,component:J,disabled:C,size:D,color:m,iconColor:t.isValidElement(j)&&j.props.color||m,onDelete:!!k,clickable:G,variant:_},F=Ee(W),o=J===ce?{component:u||"div",focusVisibleClassName:F.focusVisible,...k&&{disableRipple:!0}}:{};let f=null;k&&(f=h&&t.isValidElement(h)?t.cloneElement(h,{className:X(h.props.className,F.deleteIcon),onClick:T}):e.jsx(Re,{className:F.deleteIcon,onClick:T}));let P=null;c&&t.isValidElement(c)&&(P=t.cloneElement(c,{className:X(F.avatar,c.props.className)}));let N=null;j&&t.isValidElement(j)&&(N=t.cloneElement(j,{className:X(F.icon,j.props.className)}));const U={slots:R,slotProps:v},[q,H]=de("root",{elementType:Ae,externalForwardedProps:{...U,...l},ownerState:W,shouldForwardComponentProp:!0,ref:z,className:X(F.root,p),additionalProps:{disabled:G&&C?!0:void 0,tabIndex:w&&C?-1:A,...o},getSlotProps:x=>({...x,onClick:B=>{var V;(V=x.onClick)==null||V.call(x,B),y(B)},onKeyDown:B=>{var V;(V=x.onKeyDown)==null||V.call(x,B),$(B)},onKeyUp:B=>{var V;(V=x.onKeyUp)==null||V.call(x,B),M(B)}})}),[Q,Y]=de("label",{elementType:ze,externalForwardedProps:U,ownerState:W,className:F.label});return e.jsxs(q,{as:J,...H,children:[P||N,e.jsx(Q,{...Y,children:I}),f]})}),Ue="https://silitzer-pharma.onrender.com",Be=({setIsEditing:s,viewDistributor:r,setviewDistributor:a})=>{const[i,c]=t.useState(!1),p=m=>{const{name:u,value:h}=m.target;a(C=>({...C,[u]:h}))},b=async()=>{c(!0);try{(await fetch(`${Ue}/admin/editdistributor`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(r)})).ok||re.error("Failed to update distributor"),re.success("distributor update"),a(r),s(!1)}catch{re.error("Failed to save changes. Please try again.")}finally{c(!1)}};return i?e.jsx(ie,{message:"update distributor..."}):e.jsxs("div",{className:"edit-distributor",children:[e.jsxs("div",{className:"form-row",children:[e.jsx("label",{children:"Username:"}),e.jsx("input",{type:"text",name:"username",value:r.username||"",onChange:p})]}),e.jsxs("div",{className:"form-row",children:[e.jsx("label",{children:"Password:"}),e.jsx("input",{type:"text",name:"password",placeholder:"Enter New Password",value:r.password||"",onChange:p})]}),e.jsxs("div",{className:"form-row",children:[e.jsx("label",{children:"Name:"}),e.jsx("input",{type:"text",name:"name",value:r.name||"",onChange:p})]}),e.jsxs("div",{className:"form-row",children:[e.jsx("label",{children:"Email:"}),e.jsx("input",{type:"email",name:"email",value:r.email||"",onChange:p})]}),e.jsxs("div",{className:"form-row",children:[e.jsx("label",{children:"Phone Number:"}),e.jsx("input",{type:"text",name:"phone_number",value:r.phone_number||"",onChange:p})]}),e.jsxs("div",{className:"form-row",children:[e.jsx("label",{children:"Address:"}),e.jsx("input",{type:"text",name:"address",value:r.address||"",onChange:p})]}),e.jsxs("div",{className:"form-row",children:[e.jsx("label",{children:"GST Number:"}),e.jsx("input",{type:"text",name:"gst_number",value:r.gst_number||"",onChange:p})]}),e.jsxs("div",{className:"form-row",children:[e.jsx("label",{children:"Drug License Number:"}),e.jsx("input",{type:"text",name:"drug_license_number",value:r.drug_license_number||"",onChange:p})]}),e.jsxs("div",{className:"edit-actions",children:[e.jsx("button",{className:"save",onClick:b,children:"Save"}),e.jsx("button",{className:"cancel",onClick:()=>s(!1),children:"Cancel"})]})]})},Ve=[{id:"order_id",label:"Order ID",width:100},{id:"order_date",label:"Order Date",width:120},{id:"order_status",label:"Order Status",width:120},{id:"payment_status",label:"Payment Status",width:130},{id:"products",label:"Products",width:150}],Me="https://silitzer-pharma.onrender.com",Ke=({distributorId:s})=>{const[r,a]=t.useState([]),[i,c]=t.useState([]),[p,b]=t.useState(!1),[m,u]=t.useState(0),[h,C]=t.useState(10),[j,I]=t.useState(0),[y,k]=t.useState("order_date"),[S,L]=t.useState("desc"),D=l=>{c(l),b(!0)},_=()=>{b(!1),c([])},A=async(l,d,z,T)=>{try{const M=await(await fetch(`${Me}/admin/distributor?id=${s}&page=${l}&limit=${d}&sortField=${z}&sortOrder=${T}`,{method:"GET",credentials:"include"})).json();a(M.orders),I(M.totalCount)}catch($){console.error("Order fetch error:",$)}};t.useEffect(()=>{A(m,h,y,S)},[m,h,y,S]);const w=(l,d)=>{u(d)},R=l=>{C(parseInt(l.target.value,10)),u(0)},v=l=>{L(y===l&&S==="asc"?"desc":"asc"),k(l),u(0)};return e.jsxs("div",{className:"DistributorOrderTable",children:[e.jsxs(ge,{component:me,children:[e.jsx(Ne,{variant:"h5",sx:{m:2},className:"title",children:"Orders"}),e.jsxs(be,{children:[e.jsx(he,{children:e.jsx(te,{children:Ve.map(l=>e.jsx(O,{sx:{width:l.width},sortDirection:y===l.id?S:!1,children:l.id!=="products"?e.jsx(fe,{active:y===l.id,direction:y===l.id?S:"asc",onClick:()=>v(l.id),children:l.label}):l.label},l.id))})}),e.jsx(xe,{children:r.map((l,d)=>e.jsxs(te,{children:[e.jsx(O,{children:l.order_id}),e.jsx(O,{children:new Date(l.order_date).toLocaleDateString()}),e.jsx(O,{children:l.order_status}),e.jsx(O,{children:l.payment_status}),e.jsx(O,{children:e.jsx(Fe,{label:"View Products",color:"primary",clickable:!0,onClick:()=>D(l.products_list)})})]},d))})]}),e.jsx(ve,{component:"div",count:j,page:m,onPageChange:w,rowsPerPage:h,onRowsPerPageChange:R,rowsPerPageOptions:[5,10,25,50]})]}),e.jsxs(ee,{open:p,onClose:_,children:[e.jsx(se,{children:"Products"}),e.jsx(ae,{children:e.jsx(De,{children:i.map((l,d)=>e.jsx(Ie,{children:e.jsx(Te,{primary:l.product_name,secondary:`Quantity: ${l.quantity}`})},d))})})]})]})},le="https://silitzer-pharma.onrender.com",Ge=({distributor:s,onClose:r,refreshDistributorsList:a,setMsgData:i})=>{const[c,p]=t.useState(!1),[b,m]=t.useState(!1),[u,h]=t.useState(!1),[C,j]=t.useState(""),[I,y]=t.useState(""),[k,S]=t.useState(null),[L,D]=t.useState(!1),[_,A]=t.useState("block"),[w,R]=t.useState((s==null?void 0:s.isBlock)||!1),[v,l]=t.useState({password:"",auth_id:s._id,distributorId:s.refId.distributorId,distributor_Id:s.refId._id,username:s.username||"",name:s.refId.name||"",email:s.refId.email||"",phone_number:s.refId.phone_number||"",address:s.refId.address||"",gst_number:s.refId.gst_number||"",drug_license_number:s.refId.drug_license_number||"",date_registered:s.refId.date_registered});if(!s)return null;const d=async()=>{try{(await fetch(`${le}/admin/removedistributor`,{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({id:s._id})})).ok?(i({show:!0,status:200,message:"Distributor removed successfully",warnings:[]}),a(),r(),p(!1)):console.error("Failed to remove distributor")}catch($){console.error("Error removing distributor:",$)}},z=async()=>{try{(await fetch(`${le}/auth/verifypassword`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:C})})).ok?(h(!1),j(""),y(""),k==="edit"?m(!0):k==="delete"&&p(!0),S(null)):y("Invalid admin password. Please try again.")}catch($){console.error("Error verifying password:",$),y("Server error. Please try again later.")}},T=async()=>{try{(await fetch(`${le}/admin/distributor/block`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({id:s._id,block:!w})})).ok?(R(!w),i({show:!0,status:200,message:`Distributor ${w?"unblocked":"blocked"} successfully`,warnings:[]}),a()):console.error("Failed to toggle block status")}catch($){console.error("Error blocking/unblocking distributor:",$)}};return e.jsxs("div",{className:"view-distributors",children:[e.jsx("div",{className:"top",children:e.jsx("button",{onClick:r,children:e.jsx(Oe,{sx:{fontSize:30}})})}),e.jsx("div",{className:"title",children:e.jsx("span",{children:"Distributor Details"})}),b?e.jsx(Be,{setIsEditing:m,viewDistributor:v,setviewDistributor:l}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"distributors-details",children:[e.jsxs("div",{className:"derails-row",children:[e.jsxs("div",{children:[e.jsx("span",{children:"User Name:"})," ",v.username]}),e.jsxs("div",{children:[e.jsx("span",{children:"Distributor ID:"}),v.distributorId]})]}),e.jsxs("div",{className:"derails-row",children:[e.jsxs("div",{children:[e.jsx("span",{children:"Name:"})," ",v.name]}),e.jsxs("div",{children:[e.jsx("span",{children:"Phone Number:"})," ",v.phone_number]})]}),e.jsxs("div",{className:"derails-row",children:[e.jsxs("div",{children:[e.jsx("span",{children:"Email:"})," ",v.email]}),e.jsxs("div",{children:[e.jsx("span",{children:"Address:"})," ",v.address]})]}),e.jsxs("div",{className:"derails-row",children:[e.jsxs("div",{children:[e.jsx("span",{children:"GST Number:"})," ",v.gst_number]}),e.jsxs("div",{children:[e.jsx("span",{children:"Drug License Number:"})," ",v.drug_license_number]})]}),e.jsx("div",{className:"derails-row",children:e.jsxs("div",{children:[e.jsx("span",{children:"Date Registered:"})," ",v.date_registered?new Date(v.date_registered).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}):"N/A"]})})]}),e.jsxs("div",{className:"fun-btn",children:[e.jsx("button",{className:"remove",onClick:()=>{S("delete"),h(!0)},children:"Remove"}),e.jsx("button",{className:"edit",onClick:()=>{S("edit"),h(!0)},children:"Edit"}),e.jsx("button",{className:`block ${w?"unblock":""}`,onClick:()=>{A(w?"unblock":"block"),D(!0)},children:w?"Unblock":"Block"})]}),e.jsx("div",{children:e.jsx(Ke,{distributorId:v.auth_id})})]}),e.jsxs(ee,{open:c,onClose:()=>p(!1),children:[e.jsx(se,{children:"Confirm Removal"}),e.jsx(ae,{children:e.jsxs(ne,{children:["Are you sure you want to remove distributor"," ",e.jsx("strong",{children:s.refId.name}),"?"]})}),e.jsxs(oe,{children:[e.jsx(K,{onClick:()=>p(!1),color:"primary",children:"Cancel"}),e.jsx(K,{onClick:d,color:"error",variant:"contained",children:"Yes, Remove"})]})]}),e.jsxs(ee,{open:L,onClose:()=>D(!1),children:[e.jsxs(se,{children:["Confirm ",_==="block"?"Block":"Unblock"]}),e.jsx(ae,{children:e.jsxs(ne,{children:["Are you sure you want to"," ",e.jsx("strong",{children:_==="block"?"block":"unblock"})," ","distributor ",e.jsx("strong",{children:s.refId.name}),"?"]})}),e.jsxs(oe,{children:[e.jsx(K,{onClick:()=>D(!1),color:"primary",children:"Cancel"}),e.jsxs(K,{onClick:()=>{D(!1),T()},color:_==="block"?"error":"success",variant:"contained",children:["Yes, ",_==="block"?"Block":"Unblock"]})]})]}),e.jsxs(ee,{open:u,onClose:()=>{h(!1),j(""),y(""),S(null)},children:[e.jsx(se,{children:"Enter Admin Password"}),e.jsxs(ae,{children:[e.jsx(ne,{children:"Please enter the admin password to proceed."}),e.jsx(_e,{autoFocus:!0,margin:"dense",label:"Admin Password",type:"password",fullWidth:!0,variant:"standard",value:C,onChange:$=>j($.target.value),error:!!I,helperText:I})]}),e.jsxs(oe,{children:[e.jsx(K,{onClick:()=>{h(!1),j(""),y(""),S(null)},color:"primary",children:"Cancel"}),e.jsx(K,{onClick:z,color:"primary",variant:"contained",children:"Submit"})]})]})]})},Je="https://silitzer-pharma.onrender.com",We=()=>{const[s,r]=t.useState(null),[a,i]=t.useState(0),[c,p]=t.useState(10),[b,m]=t.useState("asc"),[u,h]=t.useState("distributorId"),[C,j]=t.useState(""),[I,y]=t.useState([]),[k,S]=t.useState(0),[L,D]=t.useState(!1),[_,A]=t.useState(!1),[w,R]=t.useState({show:!1,status:null,message:"",warnings:[]}),v=()=>A(o=>!o);t.useEffect(()=>{(async()=>{try{D(!0);const f=new URL(`${Je}/admin/getalldistributors`);f.searchParams.append("page",a+1),f.searchParams.append("limit",c),f.searchParams.append("sortField",u),f.searchParams.append("sortOrder",b),C.trim()!==""&&f.searchParams.append("search",C.trim());const N=await(await fetch(f.toString(),{credentials:"include"})).json();y(N.data),S(N.totalCount)}catch(f){console.error("Error fetching distributors:",f)}finally{D(!1)}})()},[_,a,c,u,b,C]);const l=o=>{r(o)},d=()=>{r(null)},z=(o,f)=>{i(f)},T=o=>{p(parseInt(o.target.value,10)),i(0)},$=o=>{m(u===o&&b==="asc"?"desc":"asc"),h(o)},M=(o,f,P)=>{var q,H,Q,Y;let N,U;return P==="distributorId"?(N=((q=o.refId)==null?void 0:q.distributorId)||"",U=((H=f.refId)==null?void 0:H.distributorId)||""):P==="addDate"?(N=new Date(((Q=o.refId)==null?void 0:Q.date_registered)||0),U=new Date(((Y=f.refId)==null?void 0:Y.date_registered)||0)):(N=o[P],U=f[P]),U<N?-1:U>N?1:0},G=(o,f)=>o==="desc"?(P,N)=>M(P,N,f):(P,N)=>-M(P,N,f),J=[...I].sort(G(b,u)),W=[{id:"distributorId",label:"Distributor ID"},{id:"username",label:"Name"},{id:"addDate",label:"Add Date"},{id:"totalOrders",label:"Total Orders"},{id:"pendingOrders",label:"Pending Orders"},{id:"paymentStatus",label:"Payment Status"}],F=I.find(o=>o._id===s);return L?e.jsx(ie,{message:"Loading Distributor  data..."}):e.jsxs("div",{className:"table",children:[s?e.jsx(Ge,{distributor:F,onClose:d,refreshDistributorsList:v,setMsgData:R}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"table-filter",children:e.jsx("input",{type:"text",placeholder:"Search by Id, name",value:C,onChange:o=>j(o.target.value),style:{padding:"0.5rem",width:"300px",fontSize:"1rem"}})}),e.jsx(ge,{component:me,className:"table-container",children:e.jsxs(be,{"aria-label":"distributors table",children:[e.jsx(he,{children:e.jsx(te,{children:W.map(o=>e.jsx(O,{align:"center",sortDirection:u===o.id?b:!1,children:e.jsx(fe,{active:u===o.id,direction:u===o.id?b:"asc",onClick:()=>$(o.id),children:o.label})},o.id))})}),e.jsx(xe,{children:J.map(o=>{var f,P;return e.jsxs(te,{hover:!0,onClick:()=>l(o._id),children:[e.jsx(O,{align:"center",children:((f=o.refId)==null?void 0:f.distributorId)||"N/A"}),e.jsx(O,{align:"center",children:o.username}),e.jsx(O,{align:"center",children:(P=o.refId)!=null&&P.date_registered?new Date(o.refId.date_registered).toLocaleDateString():"N/A"}),e.jsx(O,{align:"center",children:o.totalOrders}),e.jsx(O,{align:"center",children:o.pendingOrders}),e.jsx(O,{align:"center",children:e.jsx("span",{className:`payment ${o.paymentStatus}`,children:o.paymentStatus})})]},o._id)})})]})}),e.jsx(ve,{component:"div",count:k,page:a,onPageChange:z,rowsPerPage:c,onRowsPerPageChange:T,rowsPerPageOptions:[5,10,25,50]})]}),w.show&&e.jsx(je,{status:w.status,message:w.message,warnings:w.warnings,onClose:()=>R({...w,show:!1})})]})},qe=({message:s,onClose:r})=>e.jsx("div",{className:"popmsg-overlay",children:e.jsxs("div",{className:"popmsg-box",children:[e.jsx("p",{className:"popmsg-message",children:s}),e.jsx("button",{className:"popmsg-close-btn",onClick:r,children:"Close"})]})}),He="https://silitzer-pharma.onrender.com",Qe=({handleAddNew:s,refreshDistributorsList:r,setMsgData:a})=>{const[i,c]=t.useState(""),[p,b]=t.useState(""),[m,u]=t.useState(""),[h,C]=t.useState(""),[j,I]=t.useState(""),[y,k]=t.useState(""),[S,L]=t.useState(""),[D,_]=t.useState(""),[A,w]=t.useState(!1),[R,v]=t.useState(""),l=async d=>{d.preventDefault();const z={name:i,gstNumber:p,address:m,email:h,phone:j,username:y,password:S,drugLicenseNumber:D};try{w(!0);const T=await fetch(`${He}/admin/savedistributor`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({distributorDetails:z})}),$=await T.json();T.ok?(a({show:!0,status:200,message:"distributorDetails add successful!...",warnings:[]}),r(),s()):v($.msg||"Failed to add distributor")}catch(T){console.error("Error during fetch:",T),v("Network error or server not responding.")}finally{w(!1)}};return A?e.jsx(ie,{message:"Adding Distributor..."}):e.jsxs("div",{className:"distributor-form-container",children:[e.jsxs("span",{className:"title",children:["Add Distributor ",e.jsx("hr",{})]}),e.jsxs("form",{className:"distributor-form",onSubmit:l,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Username"}),e.jsx("input",{type:"text",value:y,onChange:d=>k(d.target.value),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Password"}),e.jsx("input",{type:"password",value:S,onChange:d=>L(d.target.value),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Name"}),e.jsx("input",{type:"text",value:i,onChange:d=>c(d.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Phone Number"}),e.jsx("input",{type:"tel",value:j,onChange:d=>I(d.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Email"}),e.jsx("input",{type:"email",value:h,onChange:d=>C(d.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Drug License Number"}),e.jsx("input",{type:"text",value:D,onChange:d=>_(d.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"GST Number"}),e.jsx("input",{type:"text",value:p,onChange:d=>b(d.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Address"}),e.jsx("textarea",{value:m,onChange:d=>u(d.target.value)})]}),e.jsx("button",{type:"submit",children:"Add Distributor"})]}),R&&e.jsx(qe,{message:R,onClose:()=>v("")})]})},Ye="https://silitzer-pharma.onrender.com",hs=()=>{const[s,r]=t.useState(!1),[a,i]=t.useState(!1),[c,p]=t.useState({show:!1,status:null,message:"",warnings:[]}),[b,m]=t.useState(0),u=()=>i(C=>!C),h=()=>{r(!s)};return t.useEffect(()=>{(async()=>{try{const I=await(await fetch(`${Ye}/admin/distributors/data`,{method:"GET",credentials:"include"})).json();m(I.totalCount||0)}catch(j){console.error("Failed to fetch distributor count",j)}})()},[a]),e.jsxs("div",{className:"page",children:[e.jsx("div",{className:"page-title",children:"Distributors"}),e.jsxs("div",{className:"page-nav",children:[e.jsx("button",{className:"nav-btn",onClick:h,children:s?"View Distributors":"Add New"}),e.jsxs("div",{children:["Distributors Total : ",b]})]}),s?e.jsx(Qe,{handleAddNew:h,refreshDistributorsList:u,setMsgData:p}):e.jsx(We,{refreshFlag:a,refreshDistributorsList:u}),c.show&&e.jsx(je,{status:c.status,message:c.message,warnings:c.warnings,onClose:()=>p({...c,show:!1})})]})};export{hs as default};
