import{r as t,j as s,L as E}from"./index-DlcvTWOH.js";const L="https://silitzer-pharma.onrender.com",T=[{label:"Date Asc",value:"date_asc"},{label:"Date Desc",value:"date_desc"},{label:"Status Asc",value:"status_asc"},{label:"Status Desc",value:"status_desc"}],_=["All","Processing","Shipped","Delivered","Cancelled"],$=()=>{const[g,u]=t.useState([]),[n,l]=t.useState(1),[h,x]=t.useState(1),f=5,[S,y]=t.useState(null),[b,v]=t.useState(!1),[m,P]=t.useState(""),[p,O]=t.useState(""),[c,C]=t.useState("All"),[i,D]=t.useState("date_desc");t.useEffect(()=>{const e=setTimeout(()=>{O(m.trim()),l(1)},500);return()=>clearTimeout(e)},[m]);const N=t.useCallback(async()=>{try{v(!0);const e=new URLSearchParams({page:n,limit:f});p&&e.append("search",p),c&&c!=="All"&&e.append("status",c),i&&e.append("sort",i);const d=`${L}/distributor/getallorders?${e.toString()}`,a=await(await fetch(d,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}})).json();Array.isArray(a.orders)?(u(a.orders),x(a.totalPages)):(u([]),x(1))}catch(e){console.error("Error fetching orders:",e),u([]),x(1)}finally{v(!1)}},[n,p,c,i]);t.useEffect(()=>{N()},[N]);const A=e=>{y(S===e?null:e)};return b?s.jsxs("div",{className:"modern-orders-container",children:[s.jsx("h2",{children:"Orders"}),s.jsx(E,{message:"Loading Orders..."}),";"]}):s.jsxs("div",{className:"modern-orders-container",children:[s.jsx("h2",{children:"Orders"}),s.jsxs("div",{className:"filters-container",children:[s.jsx("input",{type:"text",placeholder:"Search Order Number...",value:m,onChange:e=>P(e.target.value),className:"search-input"}),s.jsx("select",{value:c,onChange:e=>{C(e.target.value),l(1)},className:"filter-select",children:_.map(e=>s.jsx("option",{value:e,children:e},e))}),s.jsx("select",{value:i,onChange:e=>{D(e.target.value),l(1)},className:"filter-select",children:T.map(e=>s.jsx("option",{value:e.value,children:e.label},e.value))})]}),s.jsx("div",{className:"orders-list",children:g.length===0?s.jsx("p",{className:"no-orders",children:"No orders found."}):g.map((e,d)=>{var a;const j=d===S;return s.jsxs("div",{className:`order-card ${j?"expanded":""}`,children:[s.jsxs("div",{className:"order-summary",onClick:()=>A(d),children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Order #:"})," ",e.orderNumber]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Date:"})," ",new Date(e.orderDate).toLocaleDateString()]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Status:"})," ",s.jsx("span",{className:`status-badge ${e.status.toLowerCase()}`,children:e.status})]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Payment:"})," ",s.jsx("span",{className:e.paymentStatus==="Completed"?"paid":"pending",children:e.paymentStatus})]})]}),j&&s.jsxs("div",{className:"order-details",children:[s.jsxs("div",{className:"products",children:[s.jsx("strong",{children:"Products:"}),s.jsx("ul",{children:e.productList.map(r=>{var o;return s.jsxs("li",{children:[((o=r.productId)==null?void 0:o.productName)||"Unknown"," - Qty: ",r.quantity]},r._id)})})]}),s.jsxs("div",{className:"status-history",children:[s.jsx("strong",{children:"Status History:"}),s.jsx("ul",{children:(a=e.statusHistory)!=null&&a.length?e.statusHistory.map((r,o)=>s.jsxs("li",{children:[r.status," - ",new Date(r.changedAt).toLocaleString()]},o)):s.jsx("li",{children:"No history available"})})]})]})]},e._id||d)})}),s.jsxs("div",{className:"pagination-controls",children:[s.jsx("button",{onClick:()=>l(e=>Math.max(e-1,1)),disabled:n===1,children:"Prev"}),s.jsx("span",{children:`Page ${n} of ${h}`}),s.jsx("button",{onClick:()=>l(e=>Math.min(e+1,h)),disabled:n===h,children:"Next"})]})]})};export{$ as default};
