import{f as $,j as e,r as t,L as E,P as L,T as B}from"./index-DlcvTWOH.js";import{T as H}from"./TableContainer-CQmYnS7h.js";import{T as U,a as k,b as x,c as r,d as z}from"./TableRow-DuThesGT.js";import{P as I}from"./Pagination-Dncr6agV.js";import"./LastPage-DpFt_x2b.js";import"./useControlled-CHhDBfC_.js";const Z=$(e.jsx("path",{d:"M12 2C6.49 2 2 6.49 2 12s4.49 10 10 10 10-4.49 10-10S17.51 2 12 2m-1 8V6h2v4h3l-4 4-4-4zm6 7H7v-2h10z"})),S="https://silitzer-pharma.onrender.com",j=n=>n?new Date(n).toLocaleDateString("en-GB",{timeZone:"UTC",day:"2-digit",month:"2-digit",year:"numeric"}):"",J=()=>{const[n,p]=t.useState([]),[i,f]=t.useState(""),[o,b]=t.useState(""),[c,y]=t.useState("All"),[d,D]=t.useState(""),[l,P]=t.useState(""),[T,C]=t.useState(!1),[u,g]=t.useState(1),[m,N]=t.useState(1),[O,v]=t.useState(!1),w=()=>{g(1),C(s=>!s)};t.useEffect(()=>{(async()=>{try{v(!0);const h=await(await fetch(`${S}/admin/order/records?page=${u}&limit=10&startdate=${d}&enddate=${l}&status=${c}&distributor=${o}&product=${i}`,{method:"GET",credentials:"include"})).json();h.success?(p(h.data||[]),N(h.totalPages||1)):console.error("Failed to load orders:",h.message)}catch(a){console.error("Error fetching orders:",a)}finally{v(!1)}})()},[T,u]);const R=(s,a)=>{g(a)},A=()=>{const s=new URLSearchParams({startdate:d,enddate:l,status:c,distributor:o,product:i}),a=`${S}/admin/order/download-records?${s.toString()}`;window.open(a,"_blank")};return O?e.jsxs("div",{className:"OrderRecords",children:[e.jsx(E,{message:"Loading OrderRecords..."}),";"]}):e.jsxs("div",{className:"OrderRecords",children:[e.jsx("div",{className:"OrderRecords-title",children:"Order Records"}),e.jsxs("div",{className:"OrderRecords-filter",children:[e.jsxs("div",{className:"filter-date",children:[e.jsx("span",{children:"Date:"}),e.jsx("input",{type:"date",value:d,onChange:s=>D(s.target.value)}),e.jsx("span",{children:"To"}),e.jsx("input",{type:"date",value:l,onChange:s=>P(s.target.value)})]}),e.jsxs("div",{className:"filter-Status",children:[e.jsx("span",{children:"Status:"}),e.jsxs("select",{value:c,onChange:s=>y(s.target.value),children:[e.jsx("option",{value:"All",children:"All"}),e.jsx("option",{value:"Pending",children:"Pending"}),e.jsx("option",{value:"Approved",children:"Approved"}),e.jsx("option",{value:"Processing",children:"Processing"}),e.jsx("option",{value:"Shipped",children:"Shipped"}),e.jsx("option",{value:"Delivered",children:"Delivered"}),e.jsx("option",{value:"Cancelled",children:"Cancelled"}),e.jsx("option",{value:"Hold",children:"Hold"})]})]}),e.jsxs("div",{className:"filter-products",children:[e.jsx("span",{children:"Products:"}),e.jsx("input",{type:"text",value:i,onChange:s=>f(s.target.value),placeholder:"Search by product name/code"})]}),e.jsxs("div",{className:"filter-distributors",children:[e.jsx("span",{children:"Distributors:"}),e.jsx("input",{type:"text",value:o,onChange:s=>b(s.target.value),placeholder:"Search by username"})]}),e.jsxs("div",{className:"filter-search",children:[e.jsx("button",{onClick:w,children:"Search"}),e.jsx("div",{className:"filter-download",onClick:A,children:e.jsx(Z,{})})]})]}),e.jsx("div",{className:"OrderRecords-table",children:e.jsxs(L,{sx:{padding:2},children:[e.jsxs(B,{variant:"h6",gutterBottom:!0,className:"table-title",children:[e.jsxs("span",{children:[e.jsx("strong",{children:"Date:"})," ",d?j(d+"T00:00:00Z"):"start"," to ",l?j(l+"T00:00:00Z"):"end"]}),"  ",e.jsxs("span",{children:[e.jsx("strong",{children:"Status:"})," ",c||"All"]}),"  ",e.jsxs("span",{children:[e.jsx("strong",{children:"Products:"})," ",i||"All"]}),"  ",e.jsxs("span",{children:[e.jsx("strong",{children:"Distributors:"})," ",o||"All"]})]}),e.jsx(H,{children:e.jsxs(U,{children:[e.jsx(k,{children:e.jsxs(x,{children:[e.jsx(r,{children:e.jsx("strong",{children:"Order Id"})}),e.jsx(r,{children:e.jsx("strong",{children:"Distributor"})}),e.jsx(r,{children:e.jsx("strong",{children:"Order Date"})}),e.jsx(r,{children:e.jsx("strong",{children:"Order Status"})}),e.jsx(r,{children:e.jsx("strong",{children:"Payment Status"})})]})}),e.jsx(z,{children:n.length===0?e.jsx(x,{children:e.jsx(r,{colSpan:5,align:"center",children:"No orders found"})}):n.map(s=>{var a;return e.jsxs(x,{children:[e.jsx(r,{children:s.orderNumber}),e.jsx(r,{children:((a=s.distributor)==null?void 0:a.username)||"N/A"}),e.jsx(r,{children:j(s.orderDate)}),e.jsx(r,{children:s.status}),e.jsx(r,{children:s.paymentStatus})]},s._id)})})]})}),m>1&&e.jsx("div",{style:{marginTop:"20px",display:"flex",justifyContent:"center"},children:e.jsx(I,{count:m,page:u,onChange:R,color:"primary"})})]})})]})};export{J as default};
