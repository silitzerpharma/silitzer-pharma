import{r as n,j as e,B as l}from"./index-DlcvTWOH.js";import{T as o}from"./TextField-Doo77Nta.js";import{I as w,V as g,a as P}from"./VisibilityOff-BFM2Af0E.js";import{I as C}from"./IconButton-eRt6TsSc.js";import{D as k,a as A,b as N,c as T}from"./DialogTitle-DGL2koDV.js";import{D as O}from"./DialogContentText-BFDKx7jj.js";import"./Select-BpVlYiRl.js";import"./useControlled-CHhDBfC_.js";import"./useFormControl-CXPDb4oN.js";import"./InputLabel-Bd8_Eb26.js";const V="https://silitzer-pharma.onrender.com",G=()=>{const[m,u]=n.useState({username:"",name:"",email:""}),[y,c]=n.useState(!1),[a,f]=n.useState({username:"",name:"",email:"",password:"",confirmPassword:""}),[h,v]=n.useState(!1),[S,d]=n.useState(!1),[p,x]=n.useState(""),[j,b]=n.useState(!1);n.useEffect(()=>{(async()=>{try{const r=await(await fetch(`${V}/admin/profile`,{method:"GET",credentials:"include"})).json();u(r),f(D=>({...D,username:r.username,name:r.name,email:r.email||""}))}catch(t){console.error("Error fetching profile:",t)}})()},[]);const i=s=>{f(t=>({...t,[s.target.name]:s.target.value}))},E=async()=>{try{const s=await fetch("http://localhost:3000/auth/verifypassword",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:p})});if(!s.ok){const r=await s.json();alert(`Password verification failed: ${r.message}`);return}const t=await fetch("http://localhost:3000/admin/profile/update",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(t.ok)alert("Profile updated successfully"),u({username:a.username,name:a.name,email:a.email}),c(!1),f(r=>({...r,password:"",confirmPassword:""}));else{const r=await t.json();alert(`Update failed: ${r.message}`)}}catch(s){console.error("Error:",s),alert("Network error")}finally{d(!1),x("")}};return e.jsxs("div",{className:"admin-profile-container",children:[e.jsx("h2",{children:"Admin Profile"}),y?e.jsxs("div",{className:"edit-form",children:[e.jsx(o,{label:"Username",name:"username",value:a.username,onChange:i,fullWidth:!0,margin:"normal"}),e.jsx(o,{label:"Name",name:"name",value:a.name,onChange:i,fullWidth:!0,margin:"normal"}),e.jsx(o,{label:"Email",name:"email",value:a.email,onChange:i,fullWidth:!0,margin:"normal"}),e.jsx(o,{label:"New Password",name:"password",type:h?"text":"password",value:a.password,onChange:i,fullWidth:!0,margin:"normal",InputProps:{endAdornment:e.jsx(w,{position:"end",children:e.jsx(C,{onClick:()=>v(s=>!s),children:h?e.jsx(g,{}):e.jsx(P,{})})})}}),e.jsx(o,{label:"Confirm Password",name:"confirmPassword",type:h?"text":"password",value:a.confirmPassword,onChange:i,fullWidth:!0,margin:"normal"}),e.jsxs("div",{className:"form-actions",children:[e.jsx(l,{variant:"outlined",onClick:()=>c(!1),children:"Cancel"}),e.jsx(l,{variant:"contained",onClick:()=>d(!0),disabled:a.password&&a.password!==a.confirmPassword,children:"Submit"})]})]}):e.jsxs("div",{className:"profile-details",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Username:"})," ",m.username]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," ",m.name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",m.email]}),e.jsx(l,{variant:"contained",onClick:()=>c(!0),children:"Edit"})]}),e.jsxs(k,{open:S,onClose:()=>d(!1),children:[e.jsx(A,{children:"Confirm Admin Password"}),e.jsxs(N,{children:[e.jsx(O,{children:"Please enter your current password to confirm these changes."}),e.jsx(o,{autoFocus:!0,margin:"dense",label:"Admin Password",type:j?"text":"password",fullWidth:!0,value:p,onChange:s=>x(s.target.value),InputProps:{endAdornment:e.jsx(w,{position:"end",children:e.jsx(C,{onClick:()=>b(s=>!s),children:j?e.jsx(g,{}):e.jsx(P,{})})})}})]}),e.jsxs(T,{children:[e.jsx(l,{onClick:()=>d(!1),children:"Cancel"}),e.jsx(l,{variant:"contained",onClick:E,children:"Confirm"})]})]})]})};export{G as default};
